<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Abriendo…</title>
  <style>
    :root {
      --bg-body: #fbfaff;
      --bg-card: #ffffff;
      --border-color: #e9d5ff;
      --text-main: #374151;
      --text-muted: #6b7280;
      --accent: #8b5cf6;
      --accent-soft: rgba(139, 92, 246, 0.18);
      --radius: 14px;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      min-height: 100svh;
      min-height: 100dvh;
      background: radial-gradient(circle at top, rgba(167, 139, 250, 0.35) 0, var(--bg-body) 45%, rgba(167, 139, 250, 0.25) 100%);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: var(--text-main);
      -webkit-text-size-adjust: 100%;
      text-size-adjust: 100%;
    }

    .screen {
      min-height: 100vh;
      min-height: 100svh;
      min-height: 100dvh;
      width: 100%;
      display: grid;
      place-items: center;
      padding: 18px;
      position: relative;
      overflow: hidden;
    }

    .bg {
      position: absolute;
      inset: 0;
      background-position: center;
      background-size: cover;
      background-repeat: no-repeat;
      opacity: 1;
      filter: saturate(1.02);
    }

    .veil {
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top, rgba(167, 139, 250, 0.35) 0, rgba(251, 250, 255, 0.92) 45%, rgba(167, 139, 250, 0.25) 100%);
      backdrop-filter: blur(2px);
    }

    .card {
      width: 100%;
      max-width: 560px;
      background: var(--bg-card);
      border-radius: var(--radius);
      border: 1px solid var(--border-color);
      box-shadow: 0 16px 40px rgba(15, 23, 42, 0.12);
      padding: 22px;
      position: relative;
      z-index: 1;
      text-align: center;
    }

    .logo {
      width: 92px;
      height: 92px;
      border-radius: 22px;
      border: 1px solid var(--border-color);
      background: linear-gradient(135deg, rgba(139, 92, 246, 0.14), rgba(167, 139, 250, 0.14));
      display: grid;
      place-items: center;
      margin: 4px auto 14px;
      overflow: hidden;
    }

    .logo img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
    }

    h1 {
      margin: 0 0 8px;
      font-size: 1.1rem;
      color: #111827;
    }

    p {
      margin: 0;
      color: var(--text-muted);
      font-size: 0.95rem;
      line-height: 1.4;
    }

    a {
      color: var(--accent);
      font-weight: 700;
      text-decoration: none;
    }

    a:hover { text-decoration: underline; }

    .row {
      margin-top: 14px;
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 10px 14px;
      min-height: 44px;
      border-radius: 12px;
      text-decoration: none;
      border: 1px solid transparent;
      color: #ffffff;
      background: linear-gradient(135deg, #8b5cf6, #a78bfa);
      font-weight: 800;
      font-size: 0.92rem;
      white-space: nowrap;
      box-shadow: 0 10px 25px rgba(139, 92, 246, 0.18);
      touch-action: manipulation;
    }

    .btn:hover { filter: brightness(1.02); }

    .progress {
      margin-top: 14px;
      height: 10px;
      border-radius: 999px;
      background: rgba(139, 92, 246, 0.10);
      overflow: hidden;
      border: 1px solid rgba(139, 92, 246, 0.18);
    }

    .bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(135deg, rgba(139, 92, 246, 0.85), rgba(167, 139, 250, 0.85));
    }

    .bar.start {
      animation: fill var(--redirect-delay, 3000ms) linear forwards;
    }

    @keyframes fill {
      from { width: 0%; }
      to { width: 100%; }
    }

    @media (prefers-reduced-motion: reduce) {
      .bar { animation: none; width: 100%; }
    }

    @media (max-width: 480px) {
      .screen { padding: 14px; }
      .card { padding: 18px 16px; }
      h1 { font-size: 1.05rem; }
      .logo { width: 84px; height: 84px; }
      .btn { width: 100%; font-size: 1rem; }
    }
  </style>
</head>
<body>
  <div class="screen">
    <div class="bg" id="bg"></div>
    <div class="veil"></div>

    <div class="card">
      <div class="logo" id="logo">
        <img id="logoImg" alt="Logo" hidden />
      </div>

      <h1>Abriendo la aplicación…</h1>
      <p id="texto">
        Serás redirigido en <strong><span id="count">3</span> s</strong>.
      </p>

      <div class="progress" aria-hidden="true">
        <div class="bar" id="bar"></div>
      </div>

      <div class="row">
        <a class="btn" id="btnAbrir" href="https://script.google.com/macros/s/AKfycbz8Mbdyf9DULHC6R4KRSMPaiW6hyqoeitBg77jdVRuV8uLGtjAvcAjklgJqhjB1cdw0/exec" rel="noopener">Abrir ahora</a>
      </div>
    </div>
  </div>

  <script>
    (function () {
      // Fuente única del link de redirección: el href del botón "Abrir ahora".
      var btnAbrir = document.getElementById('btnAbrir');
      var url = btnAbrir ? String(btnAbrir.href || '').trim() : '';

      // Configuración
      var delay = 3000;

      // Opcional: coloca aquí una URL pública a tu logo/imagen.
      var LOGO_URL = 'logo-provida.png.webp';

      // Opcional: coloca aquí una URL pública para usar como imagen de fondo (pantalla completa).
      var BACKGROUND_IMAGE_URL = 'espera-que-ya-salgo.png';

      var count = document.getElementById('count');
      var bar = document.getElementById('bar');
      var logoImg = document.getElementById('logoImg');
      var bg = document.getElementById('bg');

      if (!url) {
        return;
      }

      try {
        document.documentElement.style.setProperty('--redirect-delay', String(delay) + 'ms');
      } catch (e) {
        // ignorar
      }

      if (LOGO_URL) {
        logoImg.src = LOGO_URL;
        logoImg.hidden = false;
      }

      if (BACKGROUND_IMAGE_URL) {
        bg.style.backgroundImage = 'url(' + BACKGROUND_IMAGE_URL + ')';
      } else {
        bg.style.backgroundImage = 'radial-gradient(circle at top, rgba(167, 139, 250, 0.35) 0, rgba(251, 250, 255, 1) 45%, rgba(167, 139, 250, 0.25) 100%)';
      }

      function go() {
        try {
          window.location.assign(url);
        } catch (e) {
          window.location.href = url;
        }
      }

      // Inicia la animación y el contador al mismo tiempo (sin reinicios)
      if (bar && bar.classList) {
        bar.classList.remove('start');
        bar.offsetHeight;
        bar.classList.add('start');
      }

      var started = Date.now();
      function updateCountdown() {
        var elapsed = Date.now() - started;
        var remaining = Math.max(0, delay - elapsed);
        var seconds = Math.ceil(remaining / 1000);
        count.textContent = String(seconds);
      }

      updateCountdown();
      var intervalId = setInterval(updateCountdown, 200);

      var timeoutId = setTimeout(function () {
        clearInterval(intervalId);
        go();
      }, delay);

      btnAbrir.addEventListener('click', function () {
        clearInterval(intervalId);
        clearTimeout(timeoutId);
      });
    })();
  </script>
</body>
</html>
